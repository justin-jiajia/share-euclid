<!DOCTYPE html>
<html>
    <head>
        <title>Straightedge and compass construction</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
        <link href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet">
        <script type="text/javascript">
            (function(c,l,a,r,i,t,y){
                c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
                y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
            })(window, document, "clarity", "script", "vkczf7k49x");
        </script>
        <style>
            body {
                margin: 0px;
                overflow: hidden;
                font-family: Arial, Helvetica, sans-serif;
                touch-action: none;
                overscroll-behavior: none;
            }
            canvas {
                margin: 0px;
                padding: 0px;
                border: 0px;
                display: block;
                touch-action: none;
            }
            #toolbar {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 10;
                display: flex;
                gap: 8px;
                align-items: center;
                padding: 8px;
                background: rgba(230, 230, 230, 0.95);
                border-bottom: 1px solid rgba(0, 0, 0, 0.2);
                overflow-x: auto;
            }
            .tool-button {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-width: 86px;
                height: 72px;
                border: 1px solid #666;
                border-radius: 8px;
                background: #fff;
                color: #111;
                cursor: pointer;
                user-select: none;
                font-size: 12px;
            }
            .tool-button:hover {
                background: #f3f3f3;
            }
            .tool-button.active {
                background: #d9ecff;
                border-color: #2f6db0;
            }
            .tool-icon {
                font-size: 20px;
                line-height: 1;
                margin-bottom: 2px;
            }
            .tool-name {
                font-size: 12px;
                font-weight: 600;
                line-height: 1.2;
            }
            .tool-instruction {
                margin-top: 2px;
                font-size: 10px;
                color: #5a5a5a;
                line-height: 1.2;
                white-space: nowrap;
            }
            #history-panel {
                position: fixed;
                right: 12px;
                top: 84px;
                width: min(380px, calc(100vw - 24px));
                max-height: min(72vh, 760px);
                min-height: 260px;
                z-index: 11;
                background: rgba(255, 255, 255, 0.96);
                border: 1px solid rgba(0, 0, 0, 0.25);
                border-radius: 10px;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
                overflow: hidden;
                display: flex;
                flex-direction: column;
            }
            #history-title {
                padding: 8px 10px;
                font-size: 13px;
                font-weight: 700;
                letter-spacing: 0.02em;
                background: linear-gradient(#f5f8ff, #e9f0ff);
                border-bottom: 1px solid rgba(0, 0, 0, 0.15);
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 8px;
            }
            .history-title-text {
                min-width: 0;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
            .history-controls {
                display: flex;
                align-items: center;
                gap: 6px;
            }
            .history-btn {
                border: 1px solid #6a7ea0;
                background: #fff;
                color: #274061;
                border-radius: 6px;
                font-size: 11px;
                font-weight: 600;
                line-height: 1;
                padding: 5px 7px;
                cursor: pointer;
            }
            .history-btn:hover {
                background: #eef4ff;
            }
            #history-list {
                list-style: none;
                margin: 0;
                padding: 8px 10px;
                overflow: auto;
                font-size: 12px;
                line-height: 1.45;
                flex: 1 1 auto;
                min-height: 90px;
            }
            #history-list li {
                padding: 2px 0;
                border-bottom: 1px dashed rgba(0, 0, 0, 0.08);
            }
            #history-list li:last-child {
                border-bottom: none;
            }
            .history-row {
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 8px;
            }
            .remark-btn {
                border: 1px solid #8fa0bc;
                border-radius: 6px;
                background: #fff;
                color: #324c73;
                font-size: 10px;
                padding: 2px 6px;
                cursor: pointer;
                flex-shrink: 0;
            }
            .remark-btn:hover {
                background: #eef4ff;
            }
            .remark-body {
                margin-top: 4px;
                background: #fafcff;
                border: 1px solid #dce7fb;
                border-radius: 6px;
                padding: 6px 8px;
                color: #1f2f46;
                font-size: 12px;
                line-height: 1.35;
                overflow-x: auto;
            }
            .remark-body > :last-child {
                margin-bottom: 0;
            }
            .history-index {
                color: #4b6489;
                font-weight: 700;
                margin-right: 4px;
            }
            .history-empty {
                color: #666;
                font-style: italic;
            }
            #remark-editor {
                border-top: 1px solid rgba(0, 0, 0, 0.12);
                padding: 8px 10px;
                background: #f7faff;
                display: none;
                flex: 0 0 auto;
            }
            #remark-editor.open {
                display: block;
            }
            #remark-label {
                font-size: 12px;
                font-weight: 600;
                color: #2d4669;
                margin-bottom: 6px;
            }
            #remark-input {
                width: 100%;
                min-height: 72px;
                resize: vertical;
                box-sizing: border-box;
                border: 1px solid #a6bbdc;
                border-radius: 6px;
                padding: 6px 8px;
                font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
                font-size: 12px;
            }
            .remark-actions {
                margin-top: 6px;
                display: flex;
                justify-content: flex-end;
                gap: 6px;
            }
            #info-modal {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.45);
                z-index: 20;
                display: none;
                align-items: center;
                justify-content: center;
                padding: 16px;
            }
            #info-modal.open {
                display: flex;
            }
            #info-card {
                width: min(760px, calc(100vw - 32px));
                max-height: min(86vh, 920px);
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 12px 36px rgba(0, 0, 0, 0.35);
                border: 1px solid rgba(0, 0, 0, 0.2);
                display: flex;
                flex-direction: column;
                overflow: hidden;
            }
            #info-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 8px;
                padding: 10px 12px;
                background: linear-gradient(#f5f8ff, #e9f0ff);
                border-bottom: 1px solid rgba(0, 0, 0, 0.12);
                font-size: 14px;
                font-weight: 700;
            }
            #info-body {
                padding: 12px;
                overflow: auto;
                font-size: 13px;
                line-height: 1.4;
                color: #1d2f46;
            }
            #info-readme {
                margin: 0;
                white-space: pre-wrap;
                word-break: break-word;
                font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
                font-size: 12px;
                background: #f8fbff;
                border: 1px solid #d9e6fb;
                border-radius: 8px;
                padding: 10px;
            }
            #info-links {
                margin-top: 10px;
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
            }
            #info-links a {
                color: #1e5aa3;
                text-decoration: none;
            }
            #info-links a:hover {
                text-decoration: underline;
            }
            #info-actions {
                padding: 10px 12px;
                border-top: 1px solid rgba(0, 0, 0, 0.12);
                display: flex;
                justify-content: flex-end;
                gap: 8px;
                background: #f9fbff;
            }
            @media (max-width: 820px) {
                #toolbar {
                    gap: 6px;
                    padding: 6px;
                }
                .tool-button {
                    min-width: 70px;
                    height: 60px;
                    border-radius: 7px;
                    font-size: 11px;
                }
                .tool-icon {
                    font-size: 17px;
                }
                .tool-name {
                    font-size: 11px;
                }
                .tool-instruction {
                    font-size: 9px;
                }
                #history-panel {
                    right: 8px;
                    left: 8px;
                    width: auto;
                    top: calc(100% - min(42vh, 360px) - 8px);
                    max-height: min(42vh, 360px);
                    min-height: 180px;
                }
            }
        </style>
        <script src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
        <script src="p5.min.js"></script>
        <script type="module" src="main.js"></script>
    </head>
    <body oncontextmenu="return false;">
        <div id="toolbar"></div>
        <div id="history-panel" aria-live="polite">
            <div id="history-title">
                <span class="history-title-text">Construction history</span>
                <div class="history-controls">
                    <button id="info-btn" class="history-btn" type="button">Info</button>
                    <button id="undo-btn" class="history-btn" type="button">Undo</button>
                    <button id="redo-btn" class="history-btn" type="button">Redo</button>
                    <button id="share-btn" class="history-btn" type="button">Share</button>
                </div>
            </div>
            <ul id="history-list">
                <li class="history-empty">No constructions yet.</li>
            </ul>
            <div id="remark-editor">
                <div id="remark-label">Remark</div>
                <textarea id="remark-input" placeholder="Write markdown. Use $...$ for inline LaTeX and $$...$$ for block math."></textarea>
                <div class="remark-actions">
                    <button id="remark-cancel" class="history-btn" type="button">Cancel</button>
                    <button id="remark-save" class="history-btn" type="button">Save</button>
                </div>
            </div>
        </div>

        <div id="info-modal" aria-modal="true" role="dialog">
            <div id="info-card">
                <div id="info-header">
                    <span>Project info</span>
                    <button id="info-close" class="history-btn" type="button">Close</button>
                </div>
                <div id="info-body">
                    <pre id="info-readme">Loading README...</pre>
                    <div id="info-links">
                        <a id="info-github" href="https://github.com/justin-jiajia/share-euclid" target="_blank" rel="noopener noreferrer">GitHub: justin-jiajia/share-euclid</a>
                    </div>
                </div>
                <div id="info-actions">
                    <button id="load-default-btn" class="history-btn" type="button">Load default construction</button>
                </div>
            </div>
        </div>
    </body>
</html>
